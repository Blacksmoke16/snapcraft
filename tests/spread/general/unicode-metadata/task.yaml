summary: "Test that unicode in metadata still looks good once dumped"

prepare: |
  apt-get install diffutils
  apt-mark auto diffutils

  #shellcheck source=tests/spread/tools/snapcraft-yaml.sh
  . "$TOOLS_DIR/snapcraft-yaml.sh"
  set_base "snap/snapcraft.yaml"

restore: |
  snapcraft clean

  #shellcheck source=tests/spread/tools/snapcraft-yaml.sh
  . "$TOOLS_DIR/snapcraft-yaml.sh"
  restore_yaml "snap/snapcraft.yaml"

execute: |
  snapcraft prime

  expected_snap_yaml="$PWD/expected_snap.yaml"

  if ! diff prime/meta/snap.yaml "$expected_snap_yaml"; then
      echo "The formatting for snap.yaml is incorrect"
      exit 1
  fi
